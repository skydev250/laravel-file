//laravel project

//CadnidateController

<?php

namespace App\Http\Controllers;

use App\Models\User;
use App\Models\Post;
use App\Models\Candidate;
use Illuminate\Http\Request;
use Illuminate\Support\Facades\DB;
use Illuminate\Support\Facades\Auth;

class CandidateController extends Controller
{
    // Show registration form
    public function showRegister()
    {
        return view('candidates.register');
    }

    // Handle registration
    public function registered(Request $request)
    {
        $data = $request->validate([
            'name' => 'required|string|max:255',
            'email' => 'required|email|unique:users',
            'password' => 'required|confirmed|min:8',
        ]);

        $user = User::create([
            'name' => $data['name'],
            'email' => $data['email'],
            'password' => bcrypt($data['password']),
        ]);

        Auth::login($user);

        // Usually after login you redirect to dashboard, not back to login page
        return redirect()->route('login');
    }

    // Show login form
    public function showLogin()
    {
        return view('candidates.login');
    }

    // Handle login
    public function login(Request $request)
    {
        $credentials = $request->validate([
            'email' => 'required|email',
            'password' => 'required',
        ]);

        if (Auth::attempt($credentials)) {
            $request->session()->regenerate();
            return redirect()->intended(route('dashboard'));
        }

        return back()->withErrors([
            'email' => 'Invalid credentials.',
        ]);
    }

    public function dash()
    {
        return view('candidates.dashboard');
    }

    // Show results list with posts for filter or display
    public function resIndex()
    {
        $posts = Post::all();
        $results = Candidate::with('post')->orderBy('id')->get();
        return view('candidates.results', compact('results', 'posts'));
    }

    // Store new candidate result
    public function resStore(Request $request)
    {
        $resdata = $request->validate([
            'CandidateNationalId' => 'required|string|max:255',
            'FirstName' => 'required|string|max:255',
            'LastName' => 'required|string|max:255',
            'Gender' => 'required|in:Male,Female',
            'DateOfBirth' => 'required|date',
            'PostId' => 'required|exists:posts,PostId',
            'ExamDate' => 'required|date',
            'PhoneNumber' => 'required|string|max:20',
            'Marks' => 'required|numeric|min:0',
        ]);

        Candidate::create($resdata);

        return redirect()->route('results')->with('success', 'Candidate result added successfully.');
    }

    // Display all candidate results
    public function resDisplay()
    {
        $results = Candidate::with('post')->orderBy('CandidateNationalId')->get();
        $posts = Post::all();
        return view('candidates.results', compact('results', 'posts'));
    }

    // Show edit form for a candidate result
    public function edit($id)
    {
        $results = Candidate::findOrFail($id);
        $posts = Post::all();  // You forgot to load posts here in your original code
        return view('candidates.resultedit', compact('results', 'posts'));
    }

    // Handle update of candidate result
    public function update(Request $request, $id)
    {
        $results = Candidate::findOrFail($id);

        $dataupdate = $request->validate([
            'CandidateNationalId' => 'required|string|max:255',
            'FirstName' => 'required|string|max:255',
            'LastName' => 'required|string|max:255',
            'Gender' => 'required|in:Male,Female',
            'DateOfBirth' => 'required|date',
            'PostId' => 'required|exists:posts,PostId',
            'ExamDate' => 'required|date',
            'PhoneNumber' => 'required|string|max:20',
            'Marks' => 'required|numeric|min:0',
        ]);

        $results->update($dataupdate);

        return redirect()->route('results')->with('success', 'Candidate result updated successfully.');
    }

    // Delete candidate result
    public function destroy($id)
    {
        Candidate::destroy($id);
        return redirect()->route('results')->with('success', 'Candidate deleted successfully.');
    }
public function report()
{
    $reportData = DB::table('results as r')
        ->join('posts as p', 'r.PostId', '=', 'p.PostId')
        ->select(
            'r.CandidateNationalId',
            'r.FirstName',
            'r.LastName',
            'r.Marks',
            'r.ExamDate',
            'r.PhoneNumber',
            'p.PostName'
        )
        ->orderBy('p.PostId')
        ->orderByDesc('r.Marks')
        ->get()
        ->groupBy('PostName')
        ->map(function ($group) {
            return $group->take(5); // top 5 per post
        });

    return view('candidates.report', ['reportData' => $reportData]);
}


public function search(Request $request)
{
    $query = $request->input('query');

   $results = Candidate::whereHas('post', function ($q) use ($query) {
    $q->where('PostName', 'LIKE', "%{$query}%");
})->paginate(10);

    return view('candidates.search', compact('results'));
}

}


//PostController
<?php

namespace App\Http\Controllers;

use App\Models\Post;
use Illuminate\Http\Request;

class PostController extends Controller
{
    // Show the post creation form and list posts
    public function post()
    {
        $posts = Post::orderBy('PostId')->get();
        return view('candidates.post', compact('posts'));
    }

    // Store new post
    public function Storepost(Request $request)
    {
        $resdata = $request->validate([
            'PostName' => 'required|string|max:255',
        ]);

        Post::create($resdata);

        return redirect()->route('post')->with('success', 'Post created successfully.');
    }

    // Display all posts (not used if you combine with post() method)
    public function Displaypost()
    {
        $posts = Post::orderBy('PostId')->get();
        return view('candidates.post', compact('posts'));
    }

    // Show edit form for a post
    public function myedit($PostId)
    {
        $post = Post::findOrFail($PostId);
        return view('candidates.postedit', compact('post'));
    }

    // Handle update for a post
    public function myupdate(Request $request, $PostId)
    {
        $post = Post::findOrFail($PostId);

        $dataupdate = $request->validate([
            'PostName' => 'required|string|max:255',
        ]);

        $post->update($dataupdate);

        return redirect()->route('post')->with('success', 'Post updated successfully.');
    }

    // Delete a post
    public function delete($PostId)
    {
        Post::destroy($PostId);

        return redirect()->route('post')->with('success', 'Post deleted successfully.');
    }
}

//Post model

<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Relations\HasMany;

class Post extends Model
{
    // Define the table associated with the model
    protected $table = 'posts';

    // Set the primary key
    protected $primaryKey = 'PostId';

    // Allow mass assignment for this column
    protected $fillable = ['PostName'];

    /**
     * Get all candidates who applied for this post.
     *
     * @return \Illuminate\Database\Eloquent\Relations\HasMany
     */
    public function candidatesResults(): HasMany
    {
        return $this->hasMany(CandidatesResult::class, 'PostId', 'PostId');
    }
}

//Candidate Model

<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Relations\BelongsTo;

class Candidate extends Model
{
    // Set the actual table name
    protected $table = 'results';

    // Primary key (if it's not 'id')
    protected $primaryKey = 'CandidateNationalId';

    // If your primary key is not auto-incrementing
    public $incrementing = false;

    // If your primary key is not an integer
    protected $keyType = 'string';

    // Mass assignable fields
    protected $fillable = [
        'CandidateNationalId',
        'FirstName',
        'LastName',
        'Gender',
        'DateOfBirth',
        'PostId',
        'ExamDate',
        'PhoneNumber',
        'Marks',
    ];


    public function post(): BelongsTo
    {
        return $this->belongsTo(Post::class, 'PostId', 'PostId');
    }
}

// migration 
//post migration
<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

return new class extends Migration
{
    /**
     * Run the migrations.
     */
    public function up(): void
    {
        Schema::create('posts', function (Blueprint $table) {
            $table->id('PostId');
            $table->string('PostName');
            $table->timestamps();
        });
    }

    /**
     * Reverse the migrations.
     */
    public function down(): void
    {
        Schema::dropIfExists('posts');
    }
};

//results

<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

return new class extends Migration
{
    public function up(): void
    {
        Schema::create('results', function (Blueprint $table) {
    $table->string('CandidateNationalId')->primary();
    $table->string('FirstName');
    $table->string('LastName');
    $table->string('Gender');
    $table->date('DateOfBirth');
    $table->unsignedBigInteger('PostId');
    $table->date('ExamDate');
    $table->string('PhoneNumber');
    $table->integer('Marks');
    $table->timestamps();

    $table->foreign('PostId')->references('PostId')->on('posts')->onDelete('cascade');
           
        });
    }

    public function down(): void
    {
        Schema::dropIfExists('results');
    }
};


//Blades
//candidates folder in views

//dashboard.blade.php

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-green-100 via-blue-50 to-purple-100 min-h-screen font-sans">

    <!-- Navigation Bar -->
    <nav class="bg-green-400 shadow-md">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex justify-between h-16 items-center">
                <!-- Left Links -->
                <div class="flex space-x-6 text-sm font-medium text-white">
                    <a href="{{ route('dashboard') }}" class="hover:text-indigo-900 transition">Home</a>
                    <a href="{{ route('post') }}" class="hover:text-indigo-900 transition">Posts</a>
                    <a href="{{ route('results') }}" class="hover:text-indigo-900 transition">Candidates Results</a>
                    <a href="{{ route('report') }}" class="hover:text-indigo-900 transition">Report</a>
                </div>

                <!-- Search & Logout -->
                <div class="flex items-center space-x-4">
                    <!-- Search -->
                 <a href="{{ route('candidates.search') }}"
          class="bg-indigo-500 text-white px-4 py-1 rounded hover:bg-indigo-600 text-sm transition">
           Search
          </a>
                    <!-- Logout -->
                    <form method="POST" action="{{ route('logout') }}">
                        @csrf
                        <button type="submit" class="bg-red-500 text-white px-4 py-1 rounded hover:bg-red-600 text-sm transition">
                            Logout
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </nav>

    <!-- Welcome -->
    <div class="text-center p-6">
        <h1 class="text-3xl font-bold text-gray-800 mb-2">Welcome to Candidates Management System</h1>
        <p class="text-gray-600 text-sm">Manage all recruitment data efficiently</p>
    </div>

    <!-- Dashboard Grid -->
    <div class="p-6 max-w-7xl mx-auto">
        <h2 class="text-2xl font-semibold text-center text-indigo-700 mb-6">System Dashboard View</h2>

        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
            <a href="{{ route('inform') }}" class="bg-white shadow-xl rounded-lg p-6 hover:scale-105 hover:bg-blue-100 transition transform duration-300">
                <div class="text-xl font-semibold text-gray-700 mb-2">Information</div>
                <p class="text-sm text-gray-500">All information about open job are available here</p>
            </a>

            <a href="{{ route('post') }}" class="bg-white shadow-xl rounded-lg p-6 hover:scale-105 hover:bg-green-100 transition transform duration-300">
                <div class="text-xl font-semibold text-gray-700 mb-2">Posts</div>
                <p class="text-sm text-gray-500">All post of labors are available here</p>
            </a>

            <a href="{{ route('results') }}" class="bg-white shadow-xl rounded-lg p-6 hover:scale-105 hover:bg-yellow-100 transition transform duration-300">
                <div class="text-xl font-semibold text-gray-700 mb-2">Candidates Results</div>
                <p class="text-sm text-gray-500">All Candidates Results And Recruitment Info</p>
            </a>

            <a href="{{ route('report') }}" class="bg-white shadow-xl rounded-lg p-6 hover:scale-105 hover:bg-red-100 transition transform duration-300">
                <div class="text-xl font-semibold text-gray-700 mb-2">Report</div>
                <p class="text-sm text-gray-500">Generate and review recruitment reports</p>
            </a>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white mt-12 py-6">
        <div class="max-w-7xl mx-auto px-4 flex flex-col md:flex-row justify-between items-center">
            <div class="text-sm">
                ¬© {{ date('Y') }} XY Company Candidates Management System || All rights reserved.
            </div>
            <div class="mt-4 md:mt-0 space-x-6 text-sm">
                <a href="#" class="hover:text-blue-300">Home</a>
                <a href="#" class="hover:text-green-300">Service</a>
                <a href="#" class="hover:text-yellow-300">Contact</a>
                <a href="#" class="hover:text-red-300">About Us</a>
            </div>
        </div>
    </footer>
</body>
</html>

//login.blade.php
<!DOCTYPE html>
<html>
<head>
    <title>Login</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="flex justify-center items-center h-screen bg-gradient-to-br from-indigo-300 via-purple-200 to-pink-200 font-sans">

    <form method="POST" action="{{ route('mylogin') }}"
          class="bg-white p-8 rounded-2xl shadow-2xl w-full max-w-md transition-transform transform hover:scale-105 duration-300">
        @csrf
        @method('POST')

        <h2 class="text-3xl font-bold mb-6 text-center text-indigo-700">Welcome Back</h2>

        <!-- Email Input -->
        <div class="mb-4">
            <input type="email" name="email" placeholder="Enter your email"
                   class="w-full border border-gray-300 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-indigo-400" required>
            @error('email') <div class="text-red-500 text-sm mt-1">{{ $message }}</div> @enderror
        </div>

        <!-- Password Input with Toggle -->
        <div class="mb-6 relative">
            <input type="password" name="password" id="password"
                   placeholder="Password"
                   class="w-full border border-gray-300 rounded-lg p-3 pr-10 focus:outline-none focus:ring-2 focus:ring-indigo-400" required>
            <span onclick="togglePassword()" id="eye"
                  class="absolute top-3 right-3 text-gray-500 cursor-pointer text-lg select-none">üëÅÔ∏è</span>
            @error('password') <div class="text-red-500 text-sm mt-1">{{ $message }}</div> @enderror
        </div>

        <!-- Login Button -->
        <button type="submit"
                class="w-full bg-gradient-to-r from-indigo-500 to-purple-500 text-white py-2 rounded-lg font-semibold hover:from-purple-600 hover:to-pink-500 transition duration-300 shadow-md">
            Login
        </button>

        <!-- Navigation -->
        <p class="text-center mt-4 text-sm text-gray-700">
            Don't have an account?
            <a href="{{ route('myregister') }}" class="text-indigo-600 hover:underline">Register</a>
        </p>
    </form>

    <!-- Password Toggle Script -->
    <script>
        function togglePassword() {
            const field = document.getElementById("password");
            const eye = document.getElementById("eye");
            if (field.type === "password") {
                field.type = "text";
                eye.textContent = "üôà";
            } else {
                field.type = "password";
                eye.textContent = "üëÅÔ∏è";
            }
        }
    </script>

</body>
</html>

//post.blade.php

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Candidates Posts</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-indigo-200 via-purple-100 to-pink-200 min-h-screen p-10 font-sans">

   <div class="mb-4">
    <a href="{{ route('dashboard') }}"
       class="inline-block bg-indigo-500 hover:bg-indigo-600 text-white px-4 py-2 rounded shadow transition duration-300">
      ‚¨Ö Back to Dashboard
    </a>
  </div>
  <div class="flex flex-col lg:flex-row gap-10 max-w-7xl mx-auto">
    
    <!-- Form Section -->
    <div class="lg:w-1/3 bg-white rounded-xl shadow-xl p-6 transition hover:scale-[1.02] duration-300">
      <h1 class="text-3xl font-bold text-indigo-700 mb-6">Add Candidate Post</h1>

      <form action="{{ route('Store') }}" method="POST" class="space-y-4">
        @csrf
        @method('post')

        <input type="text" name="PostName" placeholder="Post Name"
               class="w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-400" required>

        <button type="submit"
                class="w-full bg-gradient-to-r from-green-500 to-emerald-500 text-white py-2 rounded-lg font-semibold shadow-md hover:from-green-600 hover:to-emerald-600 transition">
          ‚ûï Record Post
        </button>
      </form>
    </div>

    <!-- Table Section -->
    <div class="lg:w-2/3 bg-white rounded-xl shadow-xl p-6 overflow-x-auto transition hover:scale-[1.01] duration-300">
      <h1 class="text-3xl font-bold text-indigo-700 mb-4">Post Name Review</h1>

      <table class="min-w-full text-sm border-collapse">
        <thead class="bg-indigo-100 text-gray-700">
          <tr>
            <th class="p-3 border">ID</th>
            <th class="p-3 border">Post Name</th>
            <th class="p-3 border">Actions</th>
          </tr>
        </thead>
        <tbody class="text-gray-700">
          @forelse($posts as $index => $post)
          <tr class="hover:bg-gray-50 transition">
            <td class="p-3 border text-center">{{ $index + 1 }}</td>
            <td class="p-3 border">{{ $post->PostName }}</td>
            <td class="p-3 border">
              <div class="flex items-center gap-3 justify-center">
                <a href="{{ route('candidates.postedit', $post->PostId) }}"
                   class="text-blue-600 hover:underline font-medium">‚úèÔ∏è Edit</a>

                <form action="{{ route('candidates.postdestroy', $post->PostId) }}" method="POST"
                      onsubmit="return confirm('Are you sure you want to delete this post?')">
                  @csrf
                  @method('DELETE')
                  <button type="submit" class="text-red-600 hover:underline font-medium">üóëÔ∏è Delete</button>
                </form>
              </div>
            </td>
          </tr>
          @empty
          <tr>
            <td colspan="3" class="p-4 text-center text-gray-500">No posts found.</td>
          </tr>
          @endforelse
        </tbody>
      </table>
    </div>

  </div>
</body>
</html>

//postedit.blade.php

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>

  <!-- Flex container with vertical top alignment -->
  <div class="flex items-start">
    <!-- Form on the left -->
    <div class="fixed top-8 left-8 w-80">
      <h1 class="text-2xl font-bold">edit Post Results </h1>
     
      <form action="{{route('postedit' , $posts->PostId)}}" method="POST">
        @csrf
        @method('put')
        <input type="text" name="PostName" value="{{ $posts->PostName }}"><br><br>
       
        <button type="submit">update</button>  
</body>
</html>

//register.blade.php

<!DOCTYPE html>
<html>
<head>
  <title>Register</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen flex justify-center items-center bg-gradient-to-br from-indigo-200 via-purple-200 to-pink-200">

  <form id="myForm" onsubmit="clearForm()" method="POST" action="{{ route('myregister') }}" 
        class="bg-white p-8 rounded-xl shadow-2xl w-full max-w-md transition-transform transform hover:scale-[1.01] duration-300">
    @csrf
    @method('POST')

    <h2 class="text-3xl font-bold mb-6 text-center text-indigo-700">Create Account</h2>

    <input type="text" name="name" placeholder="Name"
           class="w-full mb-4 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-400">
    @error('name') <div class="text-red-500 text-sm mb-2">{{ $message }}</div> @enderror

    <input type="email" name="email" placeholder="Email"
           class="w-full mb-4 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-400">
    @error('email') <div class="text-red-500 text-sm mb-2">{{ $message }}</div> @enderror

    <!-- Password with show/hide -->
    <div class="relative mb-4">
      <input type="password" name="password" id="password" placeholder="Password"
             class="w-full p-3 border border-gray-300 rounded-lg pr-10 focus:outline-none focus:ring-2 focus:ring-indigo-400" required>
      <span onclick="togglePassword('password', 'eye1')" id="eye1"
            class="absolute top-3 right-3 cursor-pointer text-gray-500 text-lg select-none">üëÅÔ∏è</span>
    </div>
    @error('password') <div class="text-red-500 text-sm mb-2">{{ $message }}</div> @enderror

    <!-- Confirm Password with show/hide -->
    <div class="relative mb-4">
      <input type="password" name="password_confirmation" id="password_confirmation" placeholder="Confirm Password"
             class="w-full p-3 border border-gray-300 rounded-lg pr-10 focus:outline-none focus:ring-2 focus:ring-indigo-400" required>
      <span onclick="togglePassword('password_confirmation', 'eye2')" id="eye2"
            class="absolute top-3 right-3 cursor-pointer text-gray-500 text-lg select-none">üëÅÔ∏è</span>
    </div>

    <button type="submit"
            class="w-full bg-gradient-to-r from-indigo-500 to-purple-500 text-white font-semibold py-2 rounded-lg hover:from-purple-600 hover:to-pink-500 transition duration-300 shadow-md">
      Register
    </button>

    <div class="flex justify-between items-center mt-4 text-sm">
      <a href="{{ route('mylogin') }}" class="text-indigo-600 hover:underline">Already registered?</a>
      <a href="" class="text-pink-600 hover:underline">Forgot Password?</a>
    </div>
  </form>
<script>
  function clearForm() {
    setTimeout(() => {
      document.getElementById('myForm').reset();
    }, 100); // Delay ensures form is submitted before clearing
  }
</script>
  <!-- Toggle Password Visibility Script -->
  <script>
    function togglePassword(fieldId, eyeId) {
      const field = document.getElementById(fieldId);
      const eye = document.getElementById(eyeId);
      if (field.type === "password") {
        field.type = "text";
        eye.textContent = "üôà";
      } else {
        field.type = "password";
        eye.textContent = "üëÅÔ∏è";
      }
    }
  </script>
</body>
</html>

//report.blade.php

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Top 5 Candidates per Post</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @media print {
      .no-print {
        display: none !important;
      }
      body {
        background: white !important;
      }
      table, th, td {
        border: 1px solid black !important;
        border-collapse: collapse;
      }
      th, td {
        padding: 4px;
      }
    }
  </style>
</head>
<body class="bg-gradient-to-br from-indigo-100 to-white min-h-screen p-8">
  <div class="max-w-6xl mx-auto bg-white p-6 rounded-2xl shadow-xl border border-indigo-200">

    <div class="flex justify-between items-center mb-6 no-print">
      <h1 class="text-3xl font-extrabold text-indigo-800">Top 5 Candidates per Post</h1>
      <div class="space-x-2">
        <a href="{{ url()->previous() }}"
           class="inline-block bg-indigo-600 hover:bg-indigo-700 text-white font-semibold px-5 py-2 rounded-lg shadow-md transition duration-300">
          ‚Üê Back
        </a>
        <a href="#" onclick="window.print(); return false;"
           class="inline-block bg-green-600 hover:bg-green-700 text-white font-semibold px-5 py-2 rounded-lg shadow-md transition duration-300">
          üñ®Ô∏è Print
        </a>
      </div>
    </div>

    @forelse($reportData as $postName => $candidates)
      <div class="mb-8">
        <h2 class="text-2xl font-semibold text-indigo-700 mb-3 border-b pb-1">{{ $postName }}</h2>
        <div class="overflow-x-auto">
          <table class="min-w-full text-sm text-left border border-gray-200 rounded-lg overflow-hidden">
            <thead class="bg-indigo-100 text-gray-700">
              <tr>
                <th class="px-4 py-3 border">Stands</th>
                <th class="px-4 py-3 border">National ID</th>
                <th class="px-4 py-3 border">First Name</th>
                <th class="px-4 py-3 border">Last Name</th>
                <th class="px-4 py-3 border">Marks</th>
                <th class="px-4 py-3 border">Exam Date</th>
                <th class="px-4 py-3 border">Phone Number</th>
              </tr>
            </thead>
            <tbody>
              @foreach($candidates as $index => $candidate)
                <tr class="bg-white hover:bg-indigo-50 transition-all duration-200">
                  <td class="px-4 py-2 border text-center font-medium">{{ $index + 1 }}</td>
                  <td class="px-4 py-2 border">{{ $candidate->CandidateNationalId }}</td>
                  <td class="px-4 py-2 border">{{ $candidate->FirstName }}</td>
                  <td class="px-4 py-2 border">{{ $candidate->LastName }}</td>
                  <td class="px-4 py-2 border text-center font-bold text-indigo-700">{{ $candidate->Marks }}</td>
                  <td class="px-4 py-2 border text-center">{{ $candidate->ExamDate }}</td>
                  <td class="px-4 py-2 border text-center">{{ $candidate->PhoneNumber }}</td>
                </tr>
              @endforeach
            </tbody>
          </table>
        </div>
      </div>
    @empty
      <p class="text-gray-600">No candidates data available.</p>
    @endforelse

  </div>
</body>
</html>

//resultedit.blade.php

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta http-equiv="X-UA-Compatible" content="ie=edge"/>
  <title>Edit Candidate Result</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-10 font-sans">

  <div class="max-w-xl mx-auto bg-white p-8 rounded-lg shadow-md">
    <h1 class="text-2xl font-bold mb-6 text-gray-700">Edit Candidate Result</h1>

    <form action="{{ route('resultedit', $results->CandidateNationalId) }}" method="POST" class="space-y-4">
      @csrf
      @method('PUT')

      <div>
        <label class="block text-sm font-medium mb-1">National ID</label>
        <input type="text" name="CandidateNationalId" value="{{ $results->CandidateNationalId }}" class="w-full border border-gray-300 p-2 rounded" required>
      </div>

      <div>
        <label class="block text-sm font-medium mb-1">First Name</label>
        <input type="text" name="FirstName" value="{{ $results->FirstName }}" class="w-full border border-gray-300 p-2 rounded" required>
      </div>

      <div>
        <label class="block text-sm font-medium mb-1">Last Name</label>
        <input type="text" name="LastName" value="{{ $results->LastName }}" class="w-full border border-gray-300 p-2 rounded" required>
      </div>

      <div>
        <label class="block text-sm font-medium mb-1">Gender</label>
        <select name="Gender" class="w-full p-2 border border-gray-300 rounded" required>
          <option value="Male" {{ $results->Gender == 'Male' ? 'selected' : '' }}>Male</option>
          <option value="Female" {{ $results->Gender == 'Female' ? 'selected' : '' }}>Female</option>
        </select>
      </div>

      <div>
        <label class="block text-sm font-medium mb-1">Date of Birth</label>
        <input type="date" name="DateOfBirth" value="{{ $results->DateOfBirth }}" class="w-full border border-gray-300 p-2 rounded" required>
      </div>

      <div>
        <label class="block text-sm font-medium mb-1">Post</label>
        <select name="PostId" class="w-full p-2 border border-gray-300 rounded" required>
          @foreach ($posts as $post)
            <option value="{{ $post->PostId }}" {{ $results->PostId == $post->PostId ? 'selected' : '' }}>
              {{ $post->PostName }}
            </option>
          @endforeach
        </select>
      </div>

      <div>
        <label class="block text-sm font-medium mb-1">Exam Date</label>
        <input type="date" name="ExamDate" value="{{ $results->ExamDate }}" class="w-full border border-gray-300 p-2 rounded" required>
      </div>

      <div>
        <label class="block text-sm font-medium mb-1">Phone Number</label>
        <input type="text" name="PhoneNumber" value="{{ $results->PhoneNumber }}" class="w-full border border-gray-300 p-2 rounded" required>
      </div>

      <div>
        <label class="block text-sm font-medium mb-1">Marks</label>
        <input type="number" name="Marks" value="{{ $results->Marks }}" class="w-full border border-gray-300 p-2 rounded" required>
      </div>

      <div>
        <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded font-semibold">
          Update
        </button>
      </div>
    </form>
  </div>

</body>
</html>

//results.blade.php
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Candidates Results</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-indigo-200 via-purple-100 to-pink-100 min-h-screen p-6 font-sans">

  <!-- Back Button -->
  <div class="mb-4">
    <a href="{{ route('dashboard') }}"
       class="inline-block bg-indigo-500 hover:bg-indigo-600 text-white px-4 py-2 rounded shadow transition duration-300">
      ‚¨Ö Back to Dashboard
    </a>
  </div>

  <div class="flex flex-col lg:flex-row gap-6 max-w-[1200px] mx-auto">
    
    <!-- Form Section -->
    <div class="w-full lg:w-1/3 bg-white p-6 rounded-xl shadow-xl transition hover:scale-105 duration-300">
      <h1 class="text-3xl font-bold mb-6 text-indigo-700">Add Candidate Result</h1>

      <form action="{{ route('myStore') }}" method="POST" class="space-y-4">
        @csrf

        <div>
          <label class="block text-sm font-medium text-gray-600">National ID</label>
          <input type="text" name="CandidateNationalId" placeholder="Enter National ID"
                 class="w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-indigo-300" required />
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-600">First Name</label>
          <input type="text" name="FirstName" placeholder="Enter First Name"
                 class="w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-indigo-300" required />
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-600">Last Name</label>
          <input type="text" name="LastName" placeholder="Enter Last Name"
                 class="w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-indigo-300" required />
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-600">Gender</label>
          <select name="Gender" class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-indigo-300" required>
            <option value="">Select Gender</option>
            <option value="Male">Male</option>
            <option value="Female">Female</option>
          </select>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-600">Date of Birth</label>
          <input type="date" name="DateOfBirth"
                 class="w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-indigo-300" required />
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-600">Post</label>
          <select name="PostId" class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-indigo-300" required>
            @foreach($posts as $post)
              <option value="{{ $post->PostId }}">{{ $post->PostName }}</option>
            @endforeach
          </select>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-600">Exam Date</label>
          <input type="date" name="ExamDate"
                 class="w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-indigo-300" required />
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-600">Phone Number</label>
          <input type="text" name="PhoneNumber" placeholder="Enter Phone Number"
                 class="w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-indigo-300" required />
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-600">Marks</label>
          <input type="text" name="Marks" placeholder="Enter Marks"
                 class="w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-indigo-300" required />
        </div>

        <button type="submit"
                class="w-full bg-gradient-to-r from-green-500 to-emerald-500 text-white py-2 rounded-lg font-semibold hover:from-green-600 hover:to-emerald-600 transition duration-300">
          ‚ûï Save Candidate
        </button>
      </form>
    </div>

    <!-- Table Section -->
    <div class="w-full lg:w-2/3 bg-white p-6 rounded-xl shadow-xl overflow-x-auto transition hover:scale-105 duration-300">
      <h1 class="text-3xl font-bold mb-4 text-indigo-700">Candidates Results Review</h1>

      <table class="min-w-full border-collapse text-sm text-gray-700">
        <thead class="bg-indigo-100 text-gray-700 font-semibold">
          <tr>
            <th class="p-2 border">Id</th>
            <th class="p-2 border">National ID</th>
            <th class="p-2 border">First Name</th>
            <th class="p-2 border">Last Name</th>
            <th class="p-2 border">Gender</th>
            <th class="p-2 border">Birth Date</th>
            <th class="p-2 border">Post</th>
            <th class="p-2 border">Exam Date</th>
            <th class="p-2 border">Phone</th>
            <th class="p-2 border">Marks</th>
            <th class="p-2 border">Actions</th>
          </tr>
        </thead>
        <tbody>
          @forelse($results as $index => $result)
            <tr class="hover:bg-gray-50 transition">
              <td class="p-2 border text-center">{{ $index + 1 }}</td>
              <td class="p-2 border">{{ $result->CandidateNationalId }}</td>
              <td class="p-2 border">{{ $result->FirstName }}</td>
              <td class="p-2 border">{{ $result->LastName }}</td>
              <td class="p-2 border">{{ $result->Gender }}</td>
              <td class="p-2 border">{{ $result->DateOfBirth }}</td>
              <td class="p-2 border">{{ $result->post->PostName ?? 'N/A' }}</td>
              <td class="p-2 border">{{ $result->ExamDate }}</td>
              <td class="p-2 border">{{ $result->PhoneNumber }}</td>
              <td class="p-2 border">{{ $result->Marks }}</td>
              <td class="p-2 border">
                <div class="flex items-center gap-2 justify-center">
                  <a href="{{ route('candidates.edit', $result->CandidateNationalId) }}"
                     class="text-blue-600 hover:underline">‚úèÔ∏è Edit</a>
                  <form action="{{ route('candidates.destroy', $result->CandidateNationalId) }}" method="POST"
                        onsubmit="return confirm('Are you sure you want to delete this candidate?')">
                    @csrf
                    @method('DELETE')
                    <button type="submit" class="text-red-600 hover:underline">üóëÔ∏è</button>
                  </form>
                </div>
              </td>
            </tr>
          @empty
            <tr>
              <td colspan="11" class="text-center p-4 text-gray-500">No candidate results available.</td>
            </tr>
          @endforelse
        </tbody>
      </table>
    </div>

  </div>
</body>
</html>
//search.blade.php 

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Search Candidates</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-8 font-sans">
  <div class="max-w-4xl mx-auto bg-white p-6 rounded shadow">
    <div class="flex justify-between items-center mb-4">
      <h1 class="text-2xl font-bold text-indigo-700">Search Candidates by Post Name</h1>
      <a href="{{ url()->previous() }}"
         class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold px-4 py-2 rounded-lg shadow transition no-print">
        ‚Üê Back
      </a>
    </div>

    <form action="{{ route('candidates.search') }}" method="GET" class="flex gap-4 mb-6">
      <input type="text" name="query" placeholder="Enter Post Name"
             class="flex-grow border border-gray-300 p-2 rounded focus:ring-2 focus:ring-indigo-400" required>
      <button type="submit"
              class="bg-indigo-500 text-white px-4 py-2 rounded hover:bg-indigo-600 transition">
        Search
      </button>
    </form>

    @if(isset($results))
      @if(count($results) > 0)
        <table class="w-full border-collapse text-sm">
          <thead class="bg-indigo-100 text-gray-700">
            <tr>
              <th class="p-2 border">Id</th>
              <th class="p-2 border">Candidate Name</th>
              <th class="p-2 border">Post</th>
              <th class="p-2 border">Marks</th>
            </tr>
          </thead>
          <tbody>
            @foreach($results as $index => $candidate)
              <tr class="hover:bg-gray-50">
                <td class="p-2 border">{{ $index + 1 }}</td>
                <td class="p-2 border">{{ $candidate->FirstName }} {{ $candidate->LastName }}</td>
                <td class="p-2 border">{{ $candidate->post->PostName ?? 'N/A' }}</td>
                <td class="p-2 border">{{ $candidate->Marks }}</td>
              </tr>
            @endforeach
          </tbody>
        </table>

        <div class="mt-4">
          {{ $results->withQueryString()->links() }}
        </div>

      @else
        <p class="text-red-600 font-medium">No candidates found for that post name.</p>
      @endif
    @endif
  </div>
</body>
</html>

//Inform.blade.php in views

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>About This System</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-indigo-100 via-purple-100 to-pink-100 min-h-screen p-8 font-sans">

    <div class="max-w-4xl mx-auto bg-white shadow-xl rounded-xl p-8">
        <h1 class="text-4xl font-bold text-indigo-700 mb-4 text-center">üìò Project Overview</h1>

        <p class="text-gray-700 text-lg leading-relaxed mb-6">
            <strong>XY Company Candidates Management System</strong> is a web application designed to help warehouse managers
            efficiently manage the recruitment process and track candidate results for various job posts within the organization.
        </p>

        <h2 class="text-2xl font-semibold text-gray-800 mt-6 mb-2">üîç Key Features</h2>
        <ul class="list-disc pl-6 text-gray-700 text-base mb-6 space-y-1">
            <li>Register and login system with password security.</li>
            <li>Create, view, edit, and delete job posts.</li>
            <li>Add and manage candidate records with exam results.</li>
            <li>Generate summary reports by post, candidate marks, and performance.</li>
            <li>Search candidates by Post name.</li>
            <li>Mobile-responsive, fast, and user-friendly dashboard.</li>
            <li>Print or export candidate information and reports.</li>
        </ul>

        <h2 class="text-2xl font-semibold text-gray-800 mt-6 mb-2">üè¢ Who Uses This?</h2>
        <p class="text-gray-700 text-base mb-6">
            The system is designed for warehouse managers, HR staff, and admins at XY Company to simplify and digitize the hiring process.
            It replaces the traditional paper-based tracking, which was error-prone and time-consuming.
        </p>

        <h2 class="text-2xl font-semibold text-gray-800 mt-6 mb-2">üîê Why This Matters</h2>
        <p class="text-gray-700 text-base mb-6">
            By moving to this web-based platform, XY Company ensures:
        </p>
        <ul class="list-disc pl-6 text-gray-700 text-base space-y-1">
            <li>Data security and backup.</li>
            <li>Real-time access to candidate information.</li>
            <li>Faster decision-making and hiring.</li>
            <li>Clear and printable reports.</li>
        </ul>

        <div class="mt-8 text-center">
            <a href="{{ route('dashboard') }}" class="inline-block bg-indigo-600 text-white px-6 py-2 rounded hover:bg-indigo-700 transition">
                ‚¨Ö Back to Dashboard
            </a>
        </div>
    </div>

</body>
</html>

//web.php

<?php

use Illuminate\Support\Facades\Route;
use App\Http\Controllers\CandidateController;
use App\Http\Controllers\PostController;
use Illuminate\Support\Facades\Auth;

Route::get('/', function () {
    return view('welcome');
});

// Candidate registration and login
Route::get('/register', [CandidateController::class, 'showRegister'])->name('register');
Route::post('/register', [CandidateController::class, 'registered'])->name('myregister');

Route::get('/login', [CandidateController::class, 'showLogin'])->name('login');
Route::post('/login', [CandidateController::class, 'login'])->name('mylogin');

// Protected routes for authenticated users
Route::middleware(['auth'])->group(function () {
    Route::get('/dashboard', [CandidateController::class, 'dash'])->name('dashboard');

    // Candidate Results routes
    Route::get('/results', [CandidateController::class, 'resDisplay'])->name('results');  // show results list
    Route::post('/results', [CandidateController::class, 'resStore'])->name('myStore');   // store new result
    Route::get('/candidates/{id}/resultedit', [CandidateController::class, 'edit'])->name('candidates.edit');
    Route::put('/candidates/{id}', [CandidateController::class, 'update'])->name('resultedit');
    Route::delete('/candidates/{id}/destroy', [CandidateController::class, 'destroy'])->name('candidates.destroy');

    // Posts routes
    Route::get('/post', [PostController::class, 'post'])->name('post');              // show post form + list posts
    Route::post('/post', [PostController::class, 'Storepost'])->name('Store');       // create post

    Route::get('/post/{PostId}/edit', [PostController::class, 'myedit'])->name('candidates.postedit');
    Route::put('/post/{PostId}', [PostController::class, 'myupdate'])->name('postedit');
    Route::delete('/post/{PostId}/delete', [PostController::class, 'delete'])->name('candidates.postdestroy');

    Route::get('/report', [CandidateController::class, 'report'])->name('report');
    Route::get('/search', [CandidateController::class, 'search'])->name('candidates.search');

    Route::post('/logout', function () {
    Auth::logout();
    request()->session()->invalidate();
    request()->session()->regenerateToken();
    return redirect('/login');
})->name('logout');

Route::get('/inform', function () {return view('inform');})->name('inform');

});

